!!! html
%html{lang: 'es'}
  %head
    %title Simpla
    %meta{name: 'viewport', content: 'width=device-width, initial-scale=1.0'}
    %meta{name: 'description', content: 'Sistema Integrado de Monitoreo y Planificaci贸n Comunal'}
    %link{rel: 'shortcut icon', href:'/img/fab.png'}
    %link{:href => "https://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css", :rel => "stylesheet"}/

    %link{href: '/css/vendor/bootstrap.min.css', rel: 'stylesheet'}
    %link{href: '/css/vendor/drawer.min.css', rel: 'stylesheet'}
    %link{rel: 'stylesheet', type: 'text/css', href: '/css/styles.css'}
    %script{:src => "https://canvg.github.io/canvg/rgbcolor.js", :type => "text/javascript"}
    %script{:src => "https://canvg.github.io/canvg/StackBlur.js", :type => "text/javascript"}
    %script{:src => "https://canvg.github.io/canvg/canvg.js", :type => "text/javascript"}


    %script{:type => "text/javascript",:src  => "https://code.jquery.com/jquery.min.js"}
    %script{:type => "text/javascript",:src => "https://code.jquery.com/ui/1.12.1/jquery-ui.js"}
    %script{:src => "https://ajax.aspnetcdn.com/ajax/jquery.validate/1.7/jquery.validate.min.js", :type => "text/javascript"}
    %script{:src => "/js/zingchart/zingchart.min.js",:type => "text/javascript"}
    %script{:src => "/js/es.js", :type => "text/javascript"}
    %script{src: "/js/vendor/bootstrap.min.js"}
    %script{src: "/js/jspdf.js"}
    %script{src: "/js/standard_fonts_metrics.js"}
    %script{src: "/js/from_html.js"}
    %script{src: "/js/split_text_to_size.js"}
    %script{src: "/js/vendor/drawer.min.js"}
    %script{src: "/js/vendor/highstock.js"}
    %script{src: "/js/vendor/moment.min.js"}
    %script{src: "/js/vendor/no-data-to-display.src.js"}
    %script{src: "/js/vendor/trello-client.js"}
    %script{src: "/js/vendor/underscore-min.js"}
    %script{src: "/js/dist/ollert.min.js"}
    %script{:src => "/js/responsive-tabs.js", :type => "text/javascript"}
    %script{:src => "/js/bootstrap-sortablex.js", :type => "text/javascript"}
    %script{:src => "/js/moment.min.js", :type => "text/javascript"}    

    - if ENV['RACK_ENV'] == "production"
      :javascript
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', "#{ENV['GOOGLE_ANALYTICS_KEY']}", 'auto');
        ga('send', 'pageview');
    :javascript
      !function(a){function f(a,b){if(!(a.originalEvent.touches.length>1)){a.preventDefault();var c=a.originalEvent.changedTouches[0],d=document.createEvent("MouseEvents");d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(d)}}if(a.support.touch="ontouchend"in document,a.support.touch){var e,b=a.ui.mouse.prototype,c=b._mouseInit,d=b._mouseDestroy;b._touchStart=function(a){var b=this;!e&&b._mouseCapture(a.originalEvent.changedTouches[0])&&(e=!0,b._touchMoved=!1,f(a,"mouseover"),f(a,"mousemove"),f(a,"mousedown"))},b._touchMove=function(a){e&&(this._touchMoved=!0,f(a,"mousemove"))},b._touchEnd=function(a){e&&(f(a,"mouseup"),f(a,"mouseout"),this._touchMoved||f(a,"click"),e=!1)},b._mouseInit=function(){var b=this;b.element.bind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),c.call(b)},b._mouseDestroy=function(){var b=this;b.element.unbind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),d.call(b)}}}(jQuery);
    :javascript
      $(document).ready(function() {
        $("#boton_agregar").hide();
      });
    :javascript
      $( function() {
        $( "#datepicker1" ).datepicker({
          dateFormat: "dd-mm-yy"
        });
        $( "#datepicker2" ).datepicker({
          dateFormat: "dd-mm-yy"
        });
      } );
  %body
    %div
      %nav{class: 'navbar navbar-default navbar-static-top', role: 'navigation'}
        .container-fluid.header-naranjo
          .navbar-header{style:"position:fixed;"}
            %a.navbar-brand{href: '/',style:"margin:0;"}
              %img{src:"/img/logo-head.png",style:"max-height:50px;"}
          
          .title-header
            %h3{style:"margin-top:14px;"}
              #{@title}
            
          - if @user.nil?
            
          - else @user.nil?
            .avatar-right{style:"position:fixed;top:0px;right:10px;"}
              .avatar-right-center
                .h5.nombre-usuario
                  #{@user.login_name} #{@user.login_last_name}
                
                %ul.nav.navbar-nav.navbar-right
                  
                  %li
                    - if(@user.gravatar_hash=="default")
                      %a.settings-link{href: 'javascript:void(0)', data: { toggle: 'dropdown' } }
                        %img{src: "/img/Iconos-blancos-28.png", alt: "Profile Avatar", style: "width: 45px;"}
                        %b.caret
                    -else
                      %a.settings-link{href: 'javascript:void(0)', data: { toggle: 'dropdown' } }
                        %img{src: "https://www.gravatar.com/avatar/#{@user.gravatar_hash}?s=40", alt: "Profile Avatar"}
                        %b.caret
                    %ul.dropdown-menu.pull-right
                      %li
                        %a{href: "/logout", alt: "Log out"}
                          %span.glyphicon.glyphicon-off
                          Cerrar Sesi贸n
            

      #mainContent
        
        - if @user.nil?
            
        - else @user.nil?
          .col.md-12.col-sm-12.col-xs-12.no-padding-nav
            .drawer-contents-nav
              %ul.drawer-nav#config-drawer-board-list.no-padding
                - if @user.role!="admin"
                  .col.md.general
                    %li.icon-element
                      .col.md.izq-menu
                        %a.icon-link{href:"/dashboard?mun_id=#{@user.municipio.id}"}
                          %img.svg-element#boton{src: "/img/Iconos-blancos-26.png", type:"image/svg+xml"}
                      .col#header-lateral
                        %h5.h5-lateral
                          Indicadores Globales
                  .col.md.general
                    %li.icon-element
                      .col.md.izq-menu
                        %a.icon-link{href:"/boards"}
                          %img.svg-element#boton{src: "/img/Iconos-blancos-23.png", type:"image/svg+xml"}
                      .col#header-lateral
                        %h5.h5-lateral
                          - if @user.role=="admin" || @user.role=="secpla"
                            Gesti贸n Proyectos
                          - else
                            Proyectos
                  .col.md.general
                    %li.icon-element
                      .col.md.izq-menu
                        %a.icon-link{href:"/calendar?mun_id=#{@user.municipio.id}"}
                          %img.svg-element#boton{src: "/img/Iconos-blancos-27.png", type:"image/svg+xml"}
                      .col#header-lateral
                        %h5.h5-lateral
                          Calendario General
                  .col.md.general
                    %li.icon-element
                      .col.md.izq-menu
                        %a.icon-link{href: "/archivo/municipio/proyectos?mun_id=#{@user.municipio.id}"}
                          %img.svg-element#boton{src: "/img/Iconos-blancos-24.png", type:"image/svg+xml"}
                      .col#header-lateral
                        %h5.h5-lateral
                          Archivo de Proyectos
                - if @user.role=="admin" || @user.role=="secpla"
                  .col.md.general
                    %li.icon-element
                      .col.md.izq-menu
                        %a.icon-link{href:"/admin"}
                          %img.svg-element#boton{src: "/img/Iconos-blancos-21.png", type:"image/svg+xml"}
                      .col#header-lateral
                        %h5.h5-lateral
                          Configuraci贸n

        .col.md-12.col-sm-12.col-xs-12.principal
          - if flash.has? :error
            .row{id: 'flash', class: 'alert alert-danger'}
              .container
                #{flash[:error]}
          - if flash.has? :warning
            .row{id: 'flash', class: 'alert alert-warning'}
              .container
                #{flash[:warning]}
          - if flash.has? :success
            .row{id: 'flash', class: 'alert alert-success'}
              .container
                #{flash[:success]}
          - if flash.has? :info
            .row{id: 'flash', class: 'alert alert-info'}
              .container
                #{flash[:info]}

          = yield

       
        
    .modal

  

    - if @user.nil?
      :javascript
        $(document).ready(function(){
          $(".principal").addClass("no-padding")     
        });
       

    :javascript
      $(document).ready(function(){
      var lastName="";
        $(".icon-link").each(function() {
          $(this).parent().parent().find("#header-lateral").hide();
          if (window.location.href.includes(this.href)) {

            $(this).removeClass("icon-link");
            $(this).addClass("icon-link-hover");
            lastName=$(this).find("#boton").attr("src");
            $( this ).find(".svg-element").attr("src",lastName.replace("blancos-",""));
            $(this).hover(
              function() {
                $(this).parent().parent().find("#header-lateral").show();
              }, function() {
                $(this).parent().parent().find("#header-lateral").hide();
              }
            );
          }
          else{
            $(this).hover(
              function() {
                lastName=$(this).find("#boton").attr("src");
                $(this).parent().parent().find("#header-lateral").show();
                $( this ).find(".svg-element").attr("src",lastName.replace("blancos-",""));
              }, function() {
                $( this ).find(".svg-element").attr("src",lastName);
                $(this).parent().parent().find("#header-lateral").hide();
              }
            );
          }
        });
      });


    
      

        
      
